<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Display Webcam Stream</title>
    <style>
        html,
        body,
        canvas {
            overflow: hidden;
            position: absolute;
            height: 100%;
            width: 100%;
            left: 0px;
            top: 0px;
            padding: 0px;
            margin: 0px;
        }

        canvas {
            -o-transform: scaleX(-1);
            -moz-transform: scaleX(-1);
            -webkit-transform: scaleX(-1);
            -ms-transform: scaleX(-1);
            transform: scaleX(-1);

        }
    </style>
</head>

<body>
    <video autoplay="true" id="videoElement" style="visibility:hidden;"></video>
    <canvas style="background-color:blue;"></canvas>
    <script>
        // Put variables in global scope to make them available to the browser console.
        const video = document.querySelector('video');
        const canvas = document.querySelector('canvas');
        const ctx = canvas.getContext('2d');



        setInterval(function () {
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
        }, 33);

        function pick(event) {
            var x = event.layerX;
            var y = event.layerY;
            var pixel = ctx.getImageData(x, y, 1, 1);
            var data = pixel.data;
            var rgba = 'rgba(' + data[0] + ', ' + data[1] + ', ' + data[2] + ', ' + (data[3] / 255) + ')';
        }
        canvas.addEventListener('click', pick);

        function handleSuccess(stream) {
            window.stream = stream; // make stream available to browser console
            video.srcObject = stream;
        }
        function handleError(error) {
            console.log('navigator.MediaDevices.getUserMedia error: ', error.message, error.name);
        }
        navigator.mediaDevices.getUserMedia({ audio: false, video: true }).then(handleSuccess).catch(handleError);


        window.onresize = function () {
            var w = window.width();
            var h = window.height();
            canvas.style.height = w + "px";
            canvas.style.height = h + "px";
        };
        window.onload = function () {
            canvas.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT); //Chrome
            canvas.mozRequestFullScreen(); //Firefox

            if (!document.fullscreenElement) {
                elem.requestFullscreen().catch(err => {
                    alert(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
                });
            } else {
                document.exitFullscreen();
            }
            //now i want to cancel fullscreen
            // document.webkitCancelFullScreen(); //Chrome
            // document.mozCancelFullScreen(); //Firefox 
        }



    </script>
</body>

</html>